<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Statistical Inference for Biology: Power Calculations</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/inference-power-calc.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Statistical Inference for Biology
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Statistical Inference for Biology
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Statistical Inference for Biology
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 76%" class="percentage">
    76%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 76%" aria-valuenow="76" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/inference-power-calc.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="inference-rv-dists.html">2. Inference</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="inference-pse.html">3. Populations, Samples and Estimates</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="inference-clt.html">4. Central Limit Theorem and the t-distribution</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="inference-clt-practice.html">5. Central Limit Theorem in practice</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="inference-ttests-practice.html">6. t-tests in practice</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="inference-ci.html">7. Confidence Intervals</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        8. Power Calculations
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#power-calculations">Power Calculations</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="inference-montecarlo.html">9. Monte Carlo simulation</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="inference-permutations.html">10. Permutations</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="inference-assoc-tests.html">11. Association tests</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="eda-intro.html">12. Exploratory Data Analysis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="eda-avoid-plots.html">13. Plots to avoid</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="inference-ci.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="inference-montecarlo.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="inference-ci.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Confidence Intervals
        </a>
        <a class="chapter-link float-end" href="inference-montecarlo.html" rel="next">
          Next: Monte Carlo...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Power Calculations</h1>
        <p>Last updated on 2025-08-15 |

        <a href="https://github.com/carpentries-incubator/statistical-inference-for-biology/edit/main/episodes/inference-power-calc.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is statistical power?</li>
<li>How is power calculated?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li><ul><li>
</li></ul></li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="power-calculations">Power Calculations<a class="anchor" aria-label="anchor" href="#power-calculations"></a></h2>
<hr class="half-width"><div class="section level4">
<h4 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h4>
<p>We have used the example of the effects of two different diets on the
weight of mice. Since in this illustrative example we have access to the
population, we know that in fact there is a substantial (about 10%)
difference between the average weights of the two populations:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"./data/mice_pheno.csv"</span><span class="op">)</span> <span class="co"># Previously downloaded </span></span>
<span></span>
<span><span class="va">controlPopulation</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">pheno</span>, <span class="va">Sex</span> <span class="op">==</span> <span class="st">"F"</span> <span class="op">&amp;</span> <span class="va">Diet</span> <span class="op">==</span> <span class="st">"chow"</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">Bodyweight</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">unlist</span></span>
<span></span>
<span><span class="va">hfPopulation</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">pheno</span>, <span class="va">Sex</span> <span class="op">==</span> <span class="st">"F"</span> <span class="op">&amp;</span> <span class="va">Diet</span> <span class="op">==</span> <span class="st">"hf"</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">Bodyweight</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">unlist</span></span>
<span></span>
<span><span class="va">mu_hf</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">hfPopulation</span><span class="op">)</span></span>
<span><span class="va">mu_control</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">controlPopulation</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">mu_hf</span> <span class="op">-</span> <span class="va">mu_control</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.375517</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="op">(</span><span class="va">mu_hf</span> <span class="op">-</span> <span class="va">mu_control</span><span class="op">)</span><span class="op">/</span><span class="va">mu_control</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="co">#percent increase</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 9.942157</code></pre>
</div>
<p>We have also seen that, in some cases, when we take a sample and
perform a t-test, we don’t always get a p-value smaller than 0.05. For
example, here is a case where we take a sample of 5 mice and don’t
achieve statistical significance at the 0.05 level:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">hf</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">hfPopulation</span>, <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">controlPopulation</span>, <span class="va">N</span><span class="op">)</span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">hf</span>, <span class="va">control</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.5806661</code></pre>
</div>
<p>Did we make a mistake? By not rejecting the null hypothesis, are we
saying the diet has no effect? The answer to this question is no. All we
can say is that we did not reject the null hypothesis. But this does not
necessarily imply that the null is true. The problem is that, in this
particular instance, we don’t have enough <em>power</em>, a term we are
now going to define. If you are doing scientific research, it is very
likely that you will have to do a power calculation at some point. In
many cases, it is an ethical obligation as it can help you avoid
sacrificing mice unnecessarily or limiting the number of human subjects
exposed to potential risk in a study. Here we explain what statistical
power means.</p>
</div>
<div class="section level4">
<h4 id="types-of-error">Types of Error<a class="anchor" aria-label="anchor" href="#types-of-error"></a></h4>
<p>Whenever we perform a statistical test, we are aware that we may make
a mistake. This is why our p-values are not 0. Under the null, there is
always a positive, perhaps very small, but still positive chance that we
will reject the null when it is true. If the p-value is 0.05, it will
happen 1 out of 20 times. This <em>error</em> is called <em>type I
error</em> by statisticians.</p>
<figure><img src="fig/null-hypothesis.png" alt="Null distribution showing type I error as alpha" class="figure mx-auto d-block"></figure><p>A type I error is defined as rejecting the null when we should not.
This is also referred to as a false positive. So why do we then use
0.05? Shouldn’t we use 0.000001 to be really sure? The reason we don’t
use infinitesimal cut-offs to avoid type I errors at all cost is that
there is another error we can commit: to not reject the null when we
should. This is called a <em>type II error</em> or a false negative.</p>
<figure><img src="fig/alternative-hypothesis.png" alt="Alternative hypothesis showing type II error as beta" class="figure mx-auto d-block"></figure><p>The R code analysis above shows an example of a false negative: we
did not reject the null hypothesis (at the 0.05 level) and, because we
happen to know and peeked at the true population means, we know there is
in fact a difference. Had we used a p-value cutoff of 0.25, we would not
have made this mistake. However, in general, are we comfortable with a
type I error rate of 1 in 4? Usually we are not.</p>
</div>
<div class="section level4">
<h4 id="the-0-05-and-0-01-cut-offs-are-arbitrary">The 0.05 and 0.01 Cut-offs Are Arbitrary<a class="anchor" aria-label="anchor" href="#the-0-05-and-0-01-cut-offs-are-arbitrary"></a></h4>
<p>Most journals and regulatory agencies frequently insist that results
be significant at the 0.01 or 0.05 levels. Of course there is nothing
special about these numbers other than the fact that some of the first
papers on p-values used these values as examples. Part of the goal of
this book is to give readers a good understanding of what p-values and
confidence intervals are so that these choices can be judged in an
informed way. Unfortunately, in science, these cut-offs are applied
somewhat mindlessly, but that topic is part of a complicated debate.</p>
</div>
<div class="section level4">
<h4 id="power-calculation">Power Calculation<a class="anchor" aria-label="anchor" href="#power-calculation"></a></h4>
<p>Power is the probability of rejecting the null when the null is
false. Of course “when the null is false” is a complicated statement
because it can be false in many ways.</p>
<figure><img src="fig/delta-eq.png" class="figure mx-auto d-block"></figure><p>could be anything and the power actually depends on this parameter.
It also depends on the standard error of your estimates which in turn
depends on the sample size and the population standard deviations. In
practice, we don’t know these so we usually report power for several
plausible values of <i>Δ, σ<sub>X</sub>, σ<sub>Y</sub></i> and various
sample sizes. Statistical theory gives us formulas to calculate power.
The <code>pwr</code> package performs these calculations for you. Here
we will illustrate the concepts behind power by coding up simulations in
R.</p>
<p>Suppose our sample size is:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">12</span></span></code></pre>
</div>
<p>and we will reject the null hypothesis at:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre>
</div>
<p>What is our power with this particular data? We will compute this
probability by re-running the exercise many times and calculating the
proportion of times the null hypothesis is rejected. Specifically, we
will run:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span></code></pre>
</div>
<p>simulations. The simulation is as follows: we take a sample of size
<em>N</em> from both control and treatment groups, we perform a t-test
comparing these two, and report if the p-value is less than
<code>alpha</code> or not. We write a function that does this:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reject</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span>, <span class="va">alpha</span><span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">hf</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">hfPopulation</span>, <span class="va">N</span><span class="op">)</span> </span>
<span>   <span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">controlPopulation</span>, <span class="va">N</span><span class="op">)</span></span>
<span>   <span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">hf</span>, <span class="va">control</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>   <span class="va">pval</span> <span class="op">&lt;</span> <span class="va">alpha</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Here is an example of one simulation for a sample size of 12. The
call to <code>reject</code> answers the question “Did we reject?”</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reject</span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<p>Now we can use the <code>replicate</code> function to do this
<code>B</code> times.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rejections</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span><span class="va">B</span>, <span class="fu">reject</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Our power is just the proportion of times we correctly reject. So
with <em>N = 12</em> our power is only:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">rejections</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.2155</code></pre>
</div>
<p>This explains why the t-test was not rejecting when we knew the null
was false. With a sample size of just 12, our power is about 23%. To
guard against false positives at the 0.05 level, we had set the
threshold at a high enough level that resulted in many type II
errors.</p>
<p>Let’s see how power improves with N. We will use the function
<code>sapply</code>, which applies a function to each of the elements of
a vector. We want to repeat the above for the following sample size:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<p>So we use <code>apply</code> like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">Ns</span>,<span class="kw">function</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rejections</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span><span class="va">B</span>, <span class="fu">reject</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">mean</span><span class="op">(</span><span class="va">rejections</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre>
</div>
<p>For each of the three simulations, the above code returns the
proportion of times we reject. Not surprisingly power increases with
N:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">Ns</span>, <span class="va">power</span>, type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="fig/inference-power-calc-rendered-power_versus_sample_size-1.png" alt="Power plotted against sample size." class="figure mx-auto d-block"><figcaption>
Power plotted against sample size.
</figcaption></figure><p>Similarly, if we change the level <code>alpha</code> at which we
reject, power changes. The smaller I want the chance of type I error to
be, the less power I will have. Another way of saying this is that we
trade off between the two types of error. We can see this by writing
similar code, but keeping <em>N</em> fixed and considering several
values of <code>alpha</code>:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">alphas</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span><span class="op">)</span></span>
<span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">alphas</span>, <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rejections</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span><span class="va">B</span>, <span class="fu">reject</span><span class="op">(</span><span class="va">N</span>, alpha<span class="op">=</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">mean</span><span class="op">(</span><span class="va">rejections</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">alphas</span>, <span class="va">power</span>, xlab<span class="op">=</span><span class="st">"alpha"</span>, type<span class="op">=</span><span class="st">"b"</span>, log<span class="op">=</span><span class="st">"x"</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="fig/inference-power-calc-rendered-power_versus_alpha-1.png" alt="Power plotted against cut-off." class="figure mx-auto d-block"><figcaption>
Power plotted against cut-off.
</figcaption></figure><p>Note that the x-axis in this last plot is in the log scale.</p>
<p>There is no “right” power or “right” alpha level, but it is important
that you understand what each means.</p>
<p>To see this clearly, you could create a plot with curves of power
versus N. Show several curves in the same plot with color representing
alpha level.</p>
</div>
<div class="section level4">
<h4 id="p-values-are-arbitrary-under-the-alternative-hypothesis">p-values Are Arbitrary under the Alternative Hypothesis<a class="anchor" aria-label="anchor" href="#p-values-are-arbitrary-under-the-alternative-hypothesis"></a></h4>
<p>Another consequence of what we have learned about power is that
p-values are somewhat arbitrary when the null hypothesis is not true and
therefore the <em>alternative</em> hypothesis is true (the difference
between the population means is not zero). When the alternative
hypothesis is true, we can make a p-value as small as we want simply by
increasing the sample size (supposing that we have an infinite
population to sample from). We can show this property of p-values by
drawing larger and larger samples from our population and calculating
p-values. This works because, in our case, we know that the alternative
hypothesis is true, since we have access to the populations and can
calculate the difference in their means.</p>
<p>First write a function that returns a p-value for a given sample size
<em>N</em>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calculatePvalue</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="va">hf</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">hfPopulation</span>,<span class="va">N</span><span class="op">)</span> </span>
<span>   <span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">controlPopulation</span>,<span class="va">N</span><span class="op">)</span></span>
<span>   <span class="fu">t.test</span><span class="op">(</span><span class="va">hf</span>,<span class="va">control</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We have a limit here of 200 for the high-fat diet population, but we
can see the effect well before we get to 200. For each sample size, we
will calculate a few p-values. We can do this by repeating each value of
<em>N</em> a few times.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">10</span>,<span class="fl">200</span>,by<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">Ns_rep</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="va">Ns</span>, each<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p>Again we use <code>sapply</code> to run our simulations:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalues</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">Ns_rep</span>, <span class="va">calculatePvalue</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can plot the 10 p-values we generated for each sample
size:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">Ns_rep</span>, <span class="va">pvalues</span>, log<span class="op">=</span><span class="st">"y"</span>, xlab<span class="op">=</span><span class="st">"sample size"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"p-values"</span><span class="op">)</span></span>
<span><span class="fu">abline</span><span class="op">(</span>h<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.05</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="fig/inference-power-calc-rendered-pvals_decrease-1.png" alt="p-values from random samples at varying sample size. The actual value of the p-values decreases as we increase sample size whenever the alternative hypothesis is true." class="figure mx-auto d-block"><figcaption>
p-values from random samples at varying sample size. The actual value of
the p-values decreases as we increase sample size whenever the
alternative hypothesis is true.
</figcaption></figure><p>Note that the y-axis is log scale and that the p-values show a
decreasing trend all the way to 10<sup>-8</sup> as the sample size gets
larger. The standard cutoffs of 0.01 and 0.05 are indicated with
horizontal red lines.</p>
<p>It is important to remember that p-values are not more interesting as
they become very very small. Once we have convinced ourselves to reject
the null hypothesis at a threshold we find reasonable, having an even
smaller p-value just means that we sampled more mice than was necessary.
Having a larger sample size does help to increase the precision of our
estimate of the difference <i>Δ</i>, but the fact that the p-value
becomes very very small is just a natural consequence of the mathematics
of the test. The p-values get smaller and smaller with increasing sample
size because the numerator of the t-statistic has <i>√N</i> (for equal
sized groups, and a similar effect occurs when <i>M ≠ N</i>). Therefore,
if <i>Δ</i> is non-zero, the t-statistic will increase with
<i>N</i>.</p>
<p>Therefore, a better statistic to report is the effect size with a
confidence interval or some statistic which gives the reader a sense of
the change in a meaningful scale. We can report the effect size as a
percent by dividing the difference and the confidence interval by the
control population mean:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">hf</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">hfPopulation</span>, <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">controlPopulation</span>, <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">hf</span><span class="op">)</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">)</span></span>
<span><span class="va">diff</span> <span class="op">/</span> <span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5.196293</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">t.test</span><span class="op">(</span><span class="va">hf</span>, <span class="va">control</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span> <span class="op">/</span> <span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -7.775307 18.167892
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
<p>In addition, we can report a statistic called <a href="https://en.wikipedia.org/wiki/Effect_size#Cohen.27s_d" class="external-link">Cohen’s
d</a>, which is the difference between the groups divided by the pooled
standard deviation of the two groups.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd_pool</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu">var</span><span class="op">(</span><span class="va">hf</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu">var</span><span class="op">(</span><span class="va">control</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">N</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">diff</span> <span class="op">/</span> <span class="va">sd_pool</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3397886</code></pre>
</div>
<p>This tells us how many standard deviations of the data the mean of
the high-fat diet group is from the control group. Under the alternative
hypothesis, unlike the t-statistic which is guaranteed to increase, the
effect size and Cohen’s d will become more precise.</p>
<div id="exercises" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercises" class="callout-inner">
<h3 class="callout-title">Exercises</h3>
<div class="callout-content">
<p>For these exercises we will load the babies dataset from babies.txt.
We will use this data to review the concepts behind the p-values and
then test confidence interval concepts.
<code><a href="https://github.com/wch/downloader" class="external-link">library(downloader)</a></code><br><code>url&lt;-"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"</code><br><code>filename &lt;- basename(url)</code><br><code>download(url, destfile=filename)</code><br><code>babies &lt;- read.table("babies.txt", header=TRUE)</code><br>
This is a large dataset (1,236 cases), and we will pretend that it
contains the entire population in which we are interested. We will study
the differences in birth weight between babies born to smoking and
non-smoking mothers. First, let’s split this into two birth weight
datasets: one of birth weights to non-smoking mothers and the other of
birth weights to smoking mothers.<br><code>bwt.nonsmoke &lt;- filter(babies, smoke==0) %&gt;%</code><br><code>select(bwt) %&gt;%</code><br><code>unlist</code><br><code>bwt.smoke &lt;- filter(babies, smoke==1) %&gt;%</code><br><code>select(bwt) %&gt;%</code><br><code>unlist</code><br>
Now, we can look for the true population difference in means between
smoking and non-smoking birth weights.<br><code>library(rafalib)</code><br><code>mean(bwt.nonsmoke) - mean(bwt.smoke)</code><br><code>popsd(bwt.nonsmoke)</code><br><code>popsd(bwt.smoke)</code><br>
The population difference of mean birth weights is about 8.9 ounces. The
standard deviations of the nonsmoking and smoking groups are about 17.4
and 18.1 ounces, respectively. As we did with the mouse weight data,
this assessment interactively reviews inference concepts using
simulations in R. We will treat the babies dataset as the full
population and draw samples from it to simulate individual experiments.
We will then ask whether somebody who only received the random samples
would be able to draw correct conclusions about the population. We are
interested in testing whether the birth weights of babies born to
non-smoking mothers are significantly different from the birth weights
of babies born to smoking mothers.</p>
<ol style="list-style-type: decimal"><li>Set the seed at 1 and obtain two samples, each of size <i>N =
25</i>, from non-smoking mothers (<code>dat.ns</code>) and smoking
mothers (<code>dat.s</code>). Compute the t-statistic (call it
<code>tval</code>).</li>
<li>Recall that we summarize our data using a t-statistic because we
know that in situations where the null hypothesis is true (what we mean
when we say “under the null”) and the sample size is relatively large,
this t-value will have an approximate standard normal distribution.
Because we know the distribution of the t-value under the null, we can
quantitatively determine how unusual the observed t-value would be if
the null hypothesis were true. The standard procedure is to examine the
probability a t-statistic that actually does follow the null hypothesis
would have larger absolute value than the absolute value of the t-value
we just observed – this is called a two-sided test. We have computed
these by taking one minus the area under the standard normal curve
between <code>-abs(tval)</code> and <code>abs(tval)</code>. In R, we can
do this by using the <code>pnorm</code> function, which computes the
area under a normal curve from negative infinity up to the value given
as its first argument:</li>
<li>Because of the symmetry of the standard normal distribution, there
is a simpler way to calculate the probability that a t-value under the
null could have a larger absolute value than <code>tval</code>. Choose
the simplified calculation from the following:<br></li>
</ol><ol style="list-style-type: upper-alpha"><li>1 - 2 * pnorm(abs(tval))<br></li>
<li>1 - 2 * pnorm(-abs(tval))<br></li>
<li>1 - pnorm(-abs(tval))<br></li>
<li>2 * pnorm(-abs(tval))</li>
</ol><ol start="4" style="list-style-type: decimal"><li>By reporting only p-values, many scientific publications provide an
incomplete story of their findings. As we have mentioned, with very
large sample sizes, scientifically insignificant differences between two
groups can lead to small p-values. Confidence intervals are more
informative as they include the estimate itself. Our estimate of the
difference between babies of smoker and non-smokers:
<code>mean(dat.s)  -  mean(dat.ns)</code>. If we use the CLT, what
quantity would we add and subtract to this estimate to obtain a 99%
confidence interval?</li>
<li>If instead of CLT, we use the t-distribution approximation, what do
we add and subtract (use 2 * N - 2 degrees of freedom)?</li>
<li>Why are the values from 4 and 5 so similar?<br></li>
</ol><ol style="list-style-type: upper-alpha"><li>Coincidence.<br></li>
<li>They are both related to 99% confidence intervals.<br></li>
<li>N and thus the degrees of freedom is large enough to make the normal
and t-distributions very similar.<br></li>
<li>They are actually quite different, differing by more than 1
ounce.</li>
</ol><ol start="7" style="list-style-type: decimal"><li>No matter which way you compute it, the p-value <code>pval</code> is
the probability that the null hypothesis could have generated a
t-statistic more extreme than what we observed: <code>tval</code>. If
the p-value is very small, this means that observing a value more
extreme than <code>tval</code> would be very rare if the null hypothesis
were true, and would give strong evidence that we should reject the null
hypothesis. We determine how small the p-value needs to be to reject the
null by deciding how often we would be willing to mistakenly reject the
null hypothesis.<br>
The standard decision rule is the following: choose some small value
<i>α</i> (in most disciplines the conventional choice is <i>α</i> 0:05)
and reject the null hypothesis if the p-value is less than <i>α</i>. We
call the significance level of the test.<br>
It turns out that if we follow this decision rule, the probability that
we will reject the null hypothesis by mistake is equal to <i>α</i>.
(This fact is not immediately obvious and requires some probability
theory to show.) We call the event of rejecting the null hypothesis,
when it is in fact true, a Type I error, we call the probability of
making a Type I error, the Type I error rate, and we say that rejecting
the null hypothesis when the p-value is less than <i>α</i>, controls the
Type I error rate so that it is equal to <i>α</i>. We will see a number
of decision rules that we use in order to control the probabilities of
other types of errors. Often, we will guarantee that the probability of
an error is less than some level, but, in this case, we can guarantee
that the probability of a Type I error is exactly equal to
<i>α</i>.<br>
Which of the following sentences about a Type I error is not true?<br></li>
</ol><ol style="list-style-type: upper-alpha"><li>The following is another way to describe a Type I error: you decided
to reject the null hypothesis on the basis of data that was actually
generated by the null hypothesis.<br></li>
<li>The following is the another way to describe a Type I error: due to
random fluctuations, even though the data you observed were actually
generated by the null hypothesis, the p-value calculated from the
observed data was small, so you rejected it.<br></li>
<li>From the original data alone, you can tell whether you have made a
Type I error.<br></li>
<li>In scientific practice, a Type I error constitutes reporting a
“significant” result when there is actually no result.</li>
</ol><ol start="8" style="list-style-type: decimal"><li>In the simulation we have set up here, we know the null hypothesis
is false – the true value of difference in means is actually around 8.9.
Thus, we are concerned with how often the decision rule outlined in the
last section allows us to conclude that the null hypothesis is actually
false. In other words, we would like to quantify the Type II error rate
of the test, or the probability that we fail to reject the null
hypothesis when the alternative hypothesis is true.<br>
Unlike the Type I error rate, which we can characterize by assuming that
the null hypothesis of “no difference” is true, the Type II error rate
cannot be computed by assuming the alternative hypothesis alone because
the alternative hypothesis alone does not specify a particular value for
the difference. It thus does not nail down a specific distribution for
thet-value under the alternative.<br>
For this reason, when we study the Type II error rate of a hypothesis
testing procedure, we need to assume a particular effect size, or
hypothetical size of the difference between population means, that we
wish to target. We ask questions such as “what is the smallest
difference I could reliably distinguish from 0 given my sample size N?”
or, more commonly,“How big does N have to be in order to detect that the
absolute value of the difference is greater than zero?” Type II error
control plays a major role in designing data collection procedures
before you actually see the data, so that you know the test you will run
has enough sensitivity or power. Power is one minus the Type II error
rate, or the probability that you will reject the null hypothesis when
the alternative hypothesis is true.<br>
There are several aspects of a hypothesis test that affect its power for
a particular effect size. Intuitively, setting a lower <i>α</i>
decreases the power of the test for a given effect size because the null
hypothesis will be more difficult to reject. This means that for an
experiment with fixed parameters (i.e., with a predetermined sample
size, recording mechanism, etc), the power of the hypothesis test trades
off with its Type I error rate, no matter what effect size you
target.<br>
We can explore the trade off of power and Type I error concretely using
the babies data. Since we have the full population, we know what the
true effect size is (about 8.93) and we can compute the power of the
test for true difference between populations.<br>
Set the seed at 1 and take a random sample of N = 5 measurements from
each of the smoking and nonsmoking datasets. What is the p-value (use
the <code>t-test</code> function)?</li>
<li>The p-value is larger than 0.05 so using the typical cut-off, we
would not reject. This is a type II error. Which of the following is not
a way to decrease this type of error?<br></li>
</ol><ol style="list-style-type: upper-alpha"><li>Increase our chance of a type I error.<br></li>
<li>Take a larger sample size<br></li>
<li>Find a population for which the null is not true.<br></li>
<li>Use a higher level.</li>
</ol><ol start="10" style="list-style-type: decimal"><li>Set the seed at 1, then use the <code>replicate</code> function to
repeat the code used in exercise 9 10,000 times. What proportion of the
time do we reject at the 0.05 level?</li>
<li>Note that, not surprisingly, the power is lower than 10%. Repeat the
exercise above for samples sizes of 30, 60, 90 and 120. Which of those
four gives you power of about 80%?</li>
<li>Repeat problem 11, but now require an <i>α</i> level of 0.01. Which
of those four gives you power of about 80%?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solution to Exercises
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li><p><code>set.seed(1)</code><br><code>dat.ns &lt;- sample(bwt.nonsmoke, size = 25)</code><br><code>dat.s &lt;- sample(bwt.smoke, size = 25)</code><br><code>tval &lt;- t.test(bwt.smoke, bwt.nonsmoke)$p.value</code></p></li>
<li>
</li>
<li><p><code>se &lt;- sd(dat.ns)/sqrt(N)</code><br><code>qnorm(1-0.01/2)*se</code></p></li>
<li><p><code>qt(1-0.01/2, df=2*N-2)*se</code></p></li>
<li><p><code>set.seed(1)</code><br><code>dat.ns &lt;- sample(bwt.nonsmoke, size = 5)</code><br><code>dat.s &lt;- sample(bwt.smoke, size = 5)</code><br><code>tval &lt;- t.test(dat.ns, bdat.s)$p.value</code><br><code>tval</code></p></li>
</ol></div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>Power is the probability of detecting a real effect.</li>
<li>Effect size with a confidence interval is a more meaningful measure
than a p-value.</li>
</ul></div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="inference-ci.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="inference-montecarlo.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="inference-ci.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Confidence Intervals
        </a>
        <a class="chapter-link float-end" href="inference-montecarlo.html" rel="next">
          Next: Monte Carlo...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/statistical-inference-for-biology/edit/main/episodes/inference-power-calc.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/statistical-inference-for-biology/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/statistical-inference-for-biology/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/statistical-inference-for-biology/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:susan.mcclatchy@jax.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://carpentries-incubator.github.io/statistical-inference-for-biology/inference-power-calc.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, statistics, inference, biology",
  "name": "Power Calculations",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/statistical-inference-for-biology/inference-power-calc.html",
  "identifier": "https://carpentries-incubator.github.io/statistical-inference-for-biology/inference-power-calc.html",
  "dateCreated": "2020-02-25",
  "dateModified": "2025-08-15",
  "datePublished": "2025-08-15"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

